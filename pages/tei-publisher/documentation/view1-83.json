{
    "format": "json",
    "view": "div",
    "doc": "documentation.xml",
    "root": "3.18.19",
    "rootNode": "3.18.19",
    "id": "api-custom-endpoints",
    "odd": "docbook.odd",
    "next": "3.20",
    "previous": "3.18.17",
    "nextId": "url-routing",
    "previousId": "api-endpoints",
    "switchView": null,
    "content": "<!DOCTYPE html><html><head></head><body><div class=\"content \"><div class=\"tei-section4\" id=\"api-custom-endpoints\"><pb-observable data=\"3.18.19,3.18.19\" emit=\"transcription\">\n      <h2 class=\"tei-title7 title\">Custom API endpoints</h2>\n      <p class=\"tei-para\"> Beyond the standard server-side functionality provided by TEI Publisher, careful\n        provisions have been made to allow users to add their own API endpoints. The <a href=\"/../api.html#operations-tag-default\" class=\"tei-link4\" target=\"_new\">Custom API</a> section\n        demonstrates how project-specific functionality can be added within the OAS API scheme. </p>\n      <p class=\"tei-para\">All that is required is to edit the <span class=\"tei-link2\"><pb-edit-xml path=\"/db/apps/tei-publisher/modules/custom-api.json\">modules/custom-api.json<iron-icon icon=\"icons:open-in-new\"></iron-icon></pb-edit-xml></span> file\n        and add specifications for custom endpoints in JSON format. The\n          <span class=\"tei-parameter code\">operationId</span> property specifies the XQuery function to be called to\n        process the request. All function modules with API functions need to be imported\n        into <span class=\"tei-link2\"><pb-edit-xml path=\"/db/apps/tei-publisher/modules/custom-api.xql\">modules/custom-api.xql<iron-icon icon=\"icons:open-in-new\"></iron-icon></pb-edit-xml></span> so that the request can be correctly\n        resolved. </p>\n      <p class=\"tei-para\">The function implementation can either be added to the XQuery module <span class=\"tei-filename code\">\n          modules/custom-api.xql</span> or to a new module, which should be imported into this\n        file to make it known. The <span class=\"tei-filename code\">modules/custom-api.xql</span> shipping with TEI Publisher already \n        includes one custom endpoint used for the <a href=\"/../encyclopedia\" class=\"tei-link4\" target=\"_new\">\"Damen Conversations Lexikon\"</a>: it returns a JSON structure for consumption\n        by <span class=\"tei-tag code\">pb-split-list</span>, displaying the list of available lemmata in the encyclopedia.</p>\n      <p class=\"tei-para\">In addition, it imports a separate module from <span class=\"tei-link2\"><pb-edit-xml path=\"/db/apps/tei-publisher/modules/iiif.xql\">modules/iiif.xql<iron-icon icon=\"icons:open-in-new\"></iron-icon></pb-edit-xml></span>, containing functions for\n        generating a IIIF presentation manifest (see the <a href=\"/../test/F-rom.xml\" class=\"tei-link4\" target=\"_new\">Shakespeare example</a>):</p>\n      <pb-code-highlight class=\"tei-synopsis4\" language=\"xquery\">import module namespace iiif=\"https://stonesutras.org/api/iiif\" at \"iiif.xql\";</pb-code-highlight>\n      <p class=\"tei-para\">To reference a custom function in the <span class=\"tei-parameter code\">operationId</span> parameter of\n        <span class=\"tei-filename code\">modules/custom-api.json</span>, use the prefix <span class=\"tei-parameter code\">custom:</span> if the corresponding XQuery\n        function is available in <span class=\"tei-filename code\">modules/custom-api.xql</span>. If it resides in an imported module, use\n        the prefix defined for the import. For the IIIF module import above, this would be <span class=\"tei--element\">iiif</span>, so the operationId\n        would read:</p>\n        \n      <pb-code-highlight class=\"tei-synopsis4\" language=\"\">\"operationId\": \"iiif:manifest\",</pb-code-highlight>\n        \n      <p class=\"tei-para\">To learn more about the Open API functionality supported by roaster and the different fields and parameters available through\n        the passed in <span class=\"tei-code2 code\">$request</span> parameter, see the <a href=\"https://github.com/eeditiones/roaster\" class=\"tei-link4\" target=\"_new\">README</a> of <span class=\"tei-emphasis2\">roaster</span>.</p>\n      \n    </pb-observable></div></div></body></html>",
    "footnotes": "",
    "userParams": {
        "webcomponents": 7
    },
    "collection": "doc"
}