{
    "format": "json",
    "view": "div",
    "doc": "documentation.xml",
    "root": "3.25.13.13",
    "rootNode": "3.25.13.13",
    "id": "update5-7-copy",
    "odd": "docbook.odd",
    "next": "3.27",
    "previous": "3.25.13.11",
    "nextId": "data-organization",
    "previousId": "update5-7-newapp",
    "switchView": null,
    "content": "<!DOCTYPE html><html><head></head><body><div class=\"content \"><div class=\"tei-section3\" id=\"update5-7-copy\"><pb-observable data=\"3.25.13.13,3.25.13.13\" emit=\"transcription\">\n        <h3 class=\"tei-title6 title\">Update by copying</h3>\n        <div class=\"tei-note3 note\"><p class=\"tei-para\">\n            This approach is for experienced users only and not recommended. We mainly keep it\n              here for reference. This guide has been created for updating to TEI Publisher 6, so\n              you will also need to follow the instructions for\n            <a href=\"/?odd=docbook.odd&amp;view=div&amp;id=update6-7\" class=\"tei-link3\" target=\"\">migrating\n                from 6 to 7</a>\n            and apply the steps not described below.\n          </p></div>\n        <p class=\"tei-para\">The following steps assume that you either</p>\n        <ul class=\"tei-itemizedlist\"><li class=\"tei-listitem\">\n            <p class=\"tei-para\">have a copy of your app's code on the filesystem and either a clone of TEI\n                Publisher 6 or an app skeleton generated by TEI Publisher 6 (preferred) next to\n                it</p>\n          </li><li class=\"tei-listitem\">\n            <p class=\"tei-para\">or have your app and TEI Publisher installed in your database. In this case use\n                eXide's file manager to copy files</p>\n          </li></ul>\n        <p class=\"tei-para\">\n          In the following, the TEI Publisher 6 app you are copying from will be identified as\n          <span class=\"tei-parameter code\">$source</span>\n          .\n        </p>\n        <ol class=\"tei-procedure\"><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Edit\n              <span class=\"tei-filename code\">modules/config.xqm</span>\n              and add two variables at the top:\n              <span class=\"tei-code2 code\">$config:origin-whitelist</span>\n              and\n              <span class=\"tei-code2 code\">$config:webcomponents</span>\n              .\n            </p>\n            <p class=\"tei-para\">\n              <span class=\"tei-parameter code\">$config:webcomponents</span>\n              should point to the latest version\n                of pb-components.\n            </p>\n            <pb-code-highlight class=\"tei-programlisting5\" language=\"xquery\" line-numbers=\"line-numbers\">\n(:~\n : A list of regular expressions to check which external hosts are\n : allowed to access this TEI Publisher instance. The check is done\n : against the Origin header sent by the browser.\n :)\ndeclare variable $config:origin-whitelist := (\n\"(?:https?://localhost:.*|https?://127.0.0.1:.*)\"\n);\n\n(:~~\n : The version of the pb-components webcomponents library to be used by this app.\n : Should either point to a version published on npm,\n : or be set to 'local'. In the latter case, webcomponents\n : are assumed to be self-hosted in the app (which means you\n : have to npm install it yourself using the existing package.json).\n : If a version is given, the components will be loaded from a public CDN.\n : This is recommended unless you develop your own components.\n :)\ndeclare variable $config:webcomponents := \"0.9.11\";</pb-code-highlight>\n            <p class=\"tei-para\">\n              Other variables in\n              <span class=\"tei-filename code\">conf.xml</span>\n              which may need to be updated\n                are:\n            </p>\n            <ul class=\"tei-itemizedlist\"><li class=\"tei-listitem\">\n                <p class=\"tei-para\">$config:data-default</p>\n              </li><li class=\"tei-listitem\">\n                <p class=\"tei-para\">$config:data-exclude</p>\n              </li><li class=\"tei-listitem\">\n                <p class=\"tei-para\">$config:context-path</p>\n              </li></ul>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Copy all XQuery files from\n              <span class=\"tei-filename code\">$source/modules/lib</span>\n              into the\n              <span class=\"tei-filename code\">modules/lib</span>\n              of your application.\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Copy\n              <span class=\"tei-filename code\">$source/resources/css/theme.css</span>\n              into the same location\n                in your application.\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              In all HTML files\n              <span class=\"tei-emphasis2\">you changed for your app</span>\n              , check\n              <span class=\"tei-tag code\">head</span>\n              and remove any\n              <span class=\"tei-tag code\">script</span>\n              element or\n              <span class=\"tei-tag code\">link</span>\n              doing\n                an import like:\n            </p>\n            <pb-code-highlight class=\"tei-programlisting5\" language=\"html\" line-numbers=\"line-numbers\">&lt;link rel=\"import\" href=\"components/dependencies-dev.html\"/&gt;</pb-code-highlight>\n            <p class=\"tei-para\">Instead add the following line to the head:</p>\n            <pb-code-highlight class=\"tei-programlisting5\" language=\"html\" line-numbers=\"line-numbers\">&lt;script type=\"module\" src=\"pb-components-bundle.js\" data-template=\"pages:load-components\"&gt;&lt;/script&gt;</pb-code-highlight>\n            <p class=\"tei-para\">\n              Also add a link to\n              <span class=\"tei-filename code\">theme.css</span>\n              :\n            </p>\n            <pb-code-highlight class=\"tei-programlisting5\" language=\"html\" line-numbers=\"line-numbers\">&lt;link rel=\"stylesheet\" href=\"resources/css/theme.css\"/&gt;</pb-code-highlight>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Copy\n              <span class=\"tei-filename code\">$source/resources/css/theme.css</span>\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Copy\n              <span class=\"tei-filename code\">$source/resources/i18n</span>\n              . The existing\n              <span class=\"tei-filename code\">*.xml</span>\n              in your directory can be deleted - unless you added\n                your own translated keys, in which case you would need to move them into the\n                corresponding json format.\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              HTML files you did not change may just be overwritten by copying the\n                corresponding versions from\n              <span class=\"tei-code2 code\">$source</span>\n              . In particular this includes files\n                in the\n              <span class=\"tei-filename code\">$source/templates/basic/templates</span>\n              subdirectory.\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Copy\n              <span class=\"tei-filename code\">$source/templates/basic/controller.xql</span>\n              into the root\n                of your application - unless you made changes to this file yourself, in which case\n                you would need to merge it.\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              Check the files in modules within your app: if you have not changed any of them,\n                just copy the corresponding files from\n              <span class=\"tei-filename code\">tei-publisher-app/modules</span>\n              . See if you need to merge the\n                modified ones.\n            </p>\n          </li><li class=\"tei-step\">\n            <p class=\"tei-para\">\n              i18n translations are now applied client-side rather than server-side. This\n                means you should drop all references to\n              <span class=\"tei-code2 code\">data-template=\"i18n:translate\"</span>\n              and the i18n namespace from your HTML. Also remove the i18n module import from your\n              <span class=\"tei-filename code\">modules/view.xql</span>\n              or overwrite the file if you have not\n                modified it.\n            </p>\n          </li></ol>\n        <p class=\"tei-para\">\n          You may consult the diff of an actual update from Publisher 5 to 6 in the dodis-wall\n            repository on github:\n          <a href=\"https://github.com/eeditiones/dodis-wall/commit/9c3757d909932db458d2a777b7a952a8ee4dcc9e\" class=\"tei-link4\" target=\"_new\">update to publisher 6: update templates, configuration and\n              styling</a>\n        </p>\n      </pb-observable></div></div></body></html>",
    "footnotes": "",
    "userParams": {
        "webcomponents": 7
    },
    "collection": "doc"
}