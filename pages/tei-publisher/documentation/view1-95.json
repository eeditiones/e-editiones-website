{
    "format": "json",
    "view": "div",
    "doc": "documentation.xml",
    "root": "3.26.13",
    "rootNode": "3.26.13",
    "id": "upgrade-tp-lib-3",
    "odd": "docbook.odd",
    "next": "3.26.15",
    "previous": "3.26.11",
    "nextId": "upgrade7",
    "previousId": "upgrade7-8",
    "switchView": null,
    "content": "<!DOCTYPE html><html><head></head><body><div class=\"content \"><div class=\"tei-section3\" id=\"upgrade-tp-lib-3\"><pb-observable data=\"3.26.13,3.26.13\" emit=\"transcription\">\n      <h2 class=\"tei-title7 title\">Upgrading to tei-publisher-lib 3.0.0</h2>\n      <p class=\"tei-para\">Upgrading an app generated by TEI Publisher 7 to work with\n          <span class=\"tei-code2 code\">tei-publisher-lib</span> 3.x.x or earlier involves the following steps before\n        rebuilding and redeploying the app:</p>\n      <ol class=\"tei-procedure\"><li class=\"tei-step\">\n          <p class=\"tei-para\">Update <span class=\"tei-code2 code\">resources/odd/configuration.xml</span></p>\n          <p class=\"tei-para\">If you registered any custom XQuery module in your\n              <span class=\"tei-code2 code\">resources/odd/configuration.xml</span> for the web output mode, make sure to\n            also enable this for the print output mode by copying the corresponding configuration\n            section as below </p>\n          <p class=\"tei-para\"> If you never touched this file or don't know what it is for: skip this step. </p>\n\n          <pb-code-highlight class=\"tei-programlisting5\" language=\"xml\" line-numbers=\"line-numbers\">\n            &lt;modules&gt;\n              &lt;output mode=\"web\"&gt;\n                &lt;module uri=\"http://karlbarth.ch/apps/kb/ext-html.xql\" prefix=\"ext-html\"\n                  at=\"xmldb:exist:///db/apps/kb/modules/ext-html.xql\"/&gt;\n              &lt;/output&gt;\n              &lt;!-- we need to add this because print extends web --&gt;\n              &lt;output mode=\"print\"&gt;\n                &lt;module uri=\"http://karlbarth.ch/apps/kb/ext-html.xql\" prefix=\"ext-html\"\n                  at=\"xmldb:exist:///db/apps/kb/modules/ext-html.xql\"/&gt;\n              &lt;/output&gt;\n            &lt;/modules&gt;\n            </pb-code-highlight>\n        </li><li class=\"tei-step\">\n          <p class=\"tei-para\">Change <span class=\"tei-code2 code\">modules/lib/api/odd.xql</span> and <span class=\"tei-code2 code\">post-install.xql</span></p>\n          <p class=\"tei-para\"> Around line 68 of <span class=\"tei-code2 code\">modules/lib/api/odd.xq</span>l (function\n              <span class=\"tei-code2 code\">oapi:recompile</span>) you'll find a list of output modes. Various functions\n            rely on this list when recompiling ODDs. Add the mode fo to the list: </p>\n          <pb-code-highlight class=\"tei-programlisting5\" language=\"xquery\" line-numbers=\"line-numbers\">for $module in\n    if ($pi?output) then\n        tokenize($pi?output)\n    else\n        (\"web\", \"print\", \"latex\", \"epub\", \"fo\")\n...\n            </pb-code-highlight>\n          <p class=\"tei-para\"> You'll find a second list in function <span class=\"tei-code2 code\">local:generate-code</span> in the\n            post-installation XQuery script <span class=\"tei-code2 code\">post-install.xql</span>. Add <span class=\"tei-code2 code\">fo</span> there\n            as well. </p>\n        </li></ol>\n      <p class=\"tei-para\">More elaborate explanation of the change and various scenarios is presented in this\n          <a href=\"https://www.e-editiones.org/posts/tei-publisher-lib-3/\" class=\"tei-link4\" target=\"_new\">e-editiones article</a>.</p>\n    </pb-observable></div></div></body></html>",
    "footnotes": "",
    "userParams": {
        "webcomponents": 7
    },
    "collection": "doc"
}